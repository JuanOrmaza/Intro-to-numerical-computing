
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>OrmazaJuanHW8</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-10-27"><meta name="DC.source" content="OrmazaJuanHW8.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">CS 375 HW 8</a></li><li><a href="#2">Problem 1</a></li><li><a href="#3">Problem 2</a></li><li><a href="#4">Problem 3</a></li><li><a href="#5">Problem 4</a></li><li><a href="#6">Problem 5</a></li></ul></div><h2 id="1">CS 375 HW 8</h2><p>October 25th 2021 Juan A. Ormaza</p><pre class="codeinput">clear <span class="string">all</span>; clc; close <span class="string">all</span>;
</pre><h2 id="2">Problem 1</h2><p>Part 1 written by hand (see attachments)</p><h2 id="3">Problem 2</h2><pre class="codeinput"><span class="comment">% Part a attached (see attachments);</span>

<span class="comment">% Part b attached (see attachments);</span>

<span class="comment">% Part C</span>

x=@(i,n)-1+ i*(2/n);

f=@(x) 1./(1+25*x.^2);

n=2:2:20;

nfine=100*n;

<span class="keyword">for</span> i=1:length(nfine)

    xValPoints=0:1:nfine(i);
    xIntPoints=0:1:n(i);

    xInt=x(xIntPoints,n(i));
    yInt=f(xInt);

    xVal=x(xValPoints,nfine(i));
    yVal=f(xVal);

    figure(i)
    plot(xVal,yVal,<span class="string">'bo'</span>,<span class="string">'LineWidth'</span>,1);
    hold <span class="string">on</span>;
    c=interp_monomials(xInt,yInt);
    c=rot90(c);
    c=rot90(c);
    plot(xVal,polyval(c,xVal),<span class="string">'LineWidth'</span>,2);
    xlabel(<span class="string">'X'</span>);
    ylabel(<span class="string">'Y'</span>);
    legend(<span class="string">'y(x)'</span>,<span class="string">'interpolation P(x)'</span>);
    title(<span class="string">'data vs Interpolation n= '</span>,num2str(n(i)));

<span class="keyword">end</span>

<span class="comment">% Part D</span>

n_int=33;
N = n_int*100;
points = 0:1:N;


xIntPoints=0:1:n_int;

xInt=x(xIntPoints,n_int);
yInt=f(xInt);

xValues = x(points,N);
yValues = f(xValues);
figure(11)
plot(xValues,yValues,<span class="string">'bo'</span>,<span class="string">'LineWidth'</span>,1);
hold <span class="string">on</span>;
c=interp_monomials(xInt,yInt);
c=rot90(c);
c=rot90(c);
plot(xValues,polyval(c,xValues),<span class="string">'LineWidth'</span>,2);
xlabel(<span class="string">'X'</span>);
ylabel(<span class="string">'Y'</span>);
legend(<span class="string">'y(x)'</span>,<span class="string">'interpolation P(x)'</span>);
title(<span class="string">'data vs Interpolation n= '</span>,num2str(n_int));

fprintf(<span class="string">"for n&gt;3=3 it is possible to see how the interpolation fails to adjust to the values of f(x)\n"</span>)
fprintf(<span class="string">"this, could be due to the size of the V matrix and the ill-conditioning of the solution.\n"</span>)
fprintf(<span class="string">"moreover, the matrix is nearly singular or not scaled correctly at all.\n "</span>)
</pre><pre class="codeoutput">Warning: Matrix is close to singular or badly scaled. Results may be
inaccurate. RCOND =  1.267771e-16. 
for n&gt;3=3 it is possible to see how the interpolation fails to adjust to the values of f(x)
this, could be due to the size of the V matrix and the ill-conditioning of the solution.
moreover, the matrix is nearly singular or not scaled correctly at all.
 </pre><img vspace="5" hspace="5" src="OrmazaJuanHW8_01.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_02.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_03.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_04.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_05.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_06.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_07.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_08.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_09.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_10.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_11.png" alt=""> <h2 id="4">Problem 3</h2><pre class="codeinput">N = 33;
n_fine = 100*N;

xIntPoints=0:1:N;
xInt=x(xIntPoints,N);
yInt=f(xInt);

points = 0:1:n_fine;
xValues = x(points,n_fine);
yValues = f(xValues);

figure(12)
plot(xValues,yValues,<span class="string">'bo'</span>,<span class="string">'LineWidth'</span>,1);
hold <span class="string">on</span>;
intValues = zeros(1,n_fine);

<span class="keyword">for</span> i=1:n_fine+1
    intValues(i)=Lagrange(xInt,yInt,xValues(i));
<span class="keyword">end</span>
plot(xValues,intValues,<span class="string">'LineWidth'</span>,2);
xlabel(<span class="string">'X'</span>);
ylabel(<span class="string">'Y'</span>);
legend(<span class="string">'y(x)'</span>,<span class="string">'Lagrange interpolation P(x)'</span>);
title(<span class="string">'data vs Lagrange interpolation n= '</span>,num2str(N));

fprintf(<span class="string">'as seen in figure 12, the same bad behavior near the ends is found in the lagrange interpolation\n'</span>)
fprintf(<span class="string">'this is because lagrange interpolation also creates a polynomial that has to adjust to the curve.\n'</span>)
fprintf(<span class="string">'moreover, the equispaced interpolation points make the error increase as seen in the graph.\n'</span>)
fprintf(<span class="string">'therefore, higher ns do not increase accuracy of the interpolation\n'</span>)
</pre><pre class="codeoutput">as seen in figure 12, the same bad behavior near the ends is found in the lagrange interpolation
this is because lagrange interpolation also creates a polynomial that has to adjust to the curve.
moreover, the equispaced interpolation points make the error increase as seen in the graph.
therefore, higher ns do not increase accuracy of the interpolation
</pre><img vspace="5" hspace="5" src="OrmazaJuanHW8_12.png" alt=""> <h2 id="5">Problem 4</h2><pre class="codeinput">x_cheby=@(i,n) cos(((2*i + 1)*pi)./(2*n+2));

N = 60;
n_fine = 100*N;

xIntPoints=0:1:N;
xInt=x_cheby(xIntPoints,N);
yInt=f(xInt);

points = 0:1:n_fine;
xValues = x(points,n_fine);
yValues = f(xValues);

figure(13)
plot(xValues,yValues,<span class="string">'bo'</span>,<span class="string">'LineWidth'</span>,1);
hold <span class="string">on</span>;
intValues = zeros(1,n_fine);

<span class="keyword">for</span> i=1:n_fine+1
    intValues(i)=Lagrange(xInt,yInt,xValues(i));
<span class="keyword">end</span>

plot(xValues,intValues,<span class="string">'LineWidth'</span>,2);
xlabel(<span class="string">'X'</span>);
ylabel(<span class="string">'Y'</span>);
legend(<span class="string">'y(x)'</span>,<span class="string">'Lagrange interpolation P(x)'</span>);
title(<span class="string">'data vs Lagrange interpolation and Chebyshev points n= '</span>,num2str(N));


fprintf(<span class="string">'As seen in this example chebyshev points, in comparison to equispaced one do converge\n'</span>)
fprintf(<span class="string">'and there is a limit to the error the interpolation can have. Because of this, the interpolation\n'</span>)
fprintf(<span class="string">'behaves much better at the ends and will keep on improving as n increases.\n'</span>)
fprintf(<span class="string">'to show this, I used an n that is almost double the one in previous examples\n'</span>)
</pre><pre class="codeoutput">As seen in this example chebyshev points, in comparison to equispaced one do converge
and there is a limit to the error the interpolation can have. Because of this, the interpolation
behaves much better at the ends and will keep on improving as n increases.
to show this, I used an n that is almost double the one in previous examples
</pre><img vspace="5" hspace="5" src="OrmazaJuanHW8_13.png" alt=""> <h2 id="6">Problem 5</h2><pre class="codeinput">f1=@(x) sin(x);
f2=@(x) abs(x);

x_cheby=@(i,n) cos(((2*i + 1)*pi)./(2*n+2));

n_array=1:1:16;

fprintf(<span class="string">'Error\t sin(x)\t\t abs(x)\n'</span>);

<span class="keyword">for</span> i=1:length(n_array)
    n_fine=n_array(i)*100;

    intPoints = 1:1:n_array(i);

    x_int=x_cheby(intPoints,n_array(i));
    y_int1=f1(x_int);
    y_int2=f2(x_int);

    plotPoints = 1:1:n_fine;
    xValues = x(plotPoints,n_fine);
    y1Values = f1(xValues);
    y2Values = f2(xValues);

    sin_int=zeros(1,n_fine);
    abs_int=zeros(1,n_fine);

    <span class="keyword">for</span> j=1:n_fine
        sin_int(j)=Lagrange(x_int,y_int1,xValues(j));
        abs_int(j)=Lagrange(x_int,y_int2,xValues(j));
    <span class="keyword">end</span>


    figure(13+i)
    subplot(2,1,1)
    plot(xValues,y1Values,<span class="string">'bo'</span>);
    hold <span class="string">on</span>
    plot(xValues,sin_int,<span class="string">'r'</span>,<span class="string">'LineWidth'</span>,2);
    title(<span class="string">'data vs Lagrange interpolation and Chebyshev points n= '</span>,num2str(n_array(i)));
    legend(<span class="string">'sin(x)'</span>,<span class="string">'interpolation'</span>);
    subplot(2,1,2)
    plot(xValues,y2Values,<span class="string">'ro'</span>);
    hold <span class="string">on</span>
    plot(xValues,abs_int,<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,2);
    legend(<span class="string">'|x|'</span>,<span class="string">'interpolation'</span>)

    fprintf(<span class="string">' n=%2.0f\t %10.10f\t %10.10f\n'</span>,n_array(i),max(abs(y1Values-sin_int)),max(abs(y2Values-abs_int)));

<span class="keyword">end</span>

fprintf(<span class="string">'\n\nAs seen from the plots, it is possible to notice that the interpolation adjusts\n'</span>)
fprintf(<span class="string">'correctly to sin(x), but has trouble adjusting to abs(x). One main reason of this is because\n'</span>)
fprintf(<span class="string">'|x| is not a continuous function, thus, the interpolation polynomial will have trouble interpolation |x|\n'</span>)
fprintf(<span class="string">'this can be seen at the endpoints of the plots where the interpolation suddenly increases or decreases\n'</span>)
</pre><pre class="codeoutput">Error	 sin(x)		 abs(x)
 n= 1	 1.4911079239	 0.7071067812
 n= 2	 0.0396232083	 2.0000000000
 n= 3	 0.2592932162	 0.2705980501
 n= 4	 0.0005043694	 1.4249084145
 n= 5	 0.0073679265	 0.1725460301
 n= 6	 0.0000030235	 1.3408569429
 n= 7	 0.0000784384	 0.1274488948
 n= 8	 0.0000000105	 1.3119484318
 n= 9	 0.0000004273	 0.1012465126
 n=10	 0.0000000000	 1.2984369017
 n=11	 0.0000000014	 0.0840524134
 n=12	 0.0000000000	 1.2909913934
 n=13	 0.0000000000	 0.0718805412
 n=14	 0.0000000000	 1.2864385142
 n=15	 0.0000000000	 0.0628024108
 n=16	 0.0000000000	 1.2834459799


As seen from the plots, it is possible to notice that the interpolation adjusts
correctly to sin(x), but has trouble adjusting to abs(x). One main reason of this is because
|x| is not a continuous function, thus, the interpolation polynomial will have trouble interpolation |x|
this can be seen at the endpoints of the plots where the interpolation suddenly increases or decreases
</pre><img vspace="5" hspace="5" src="OrmazaJuanHW8_14.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_15.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_16.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_17.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_18.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_19.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_20.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_21.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_22.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_23.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_24.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_25.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_26.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_27.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_28.png" alt=""> <img vspace="5" hspace="5" src="OrmazaJuanHW8_29.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% CS 375 HW 8
% October 25th 2021
% Juan A. Ormaza

clear all; clc; close all;

%% Problem 1
% Part 1 written by hand (see attachments)

%% Problem 2

% Part a attached (see attachments);

% Part b attached (see attachments);

% Part C

x=@(i,n)-1+ i*(2/n);

f=@(x) 1./(1+25*x.^2);

n=2:2:20;

nfine=100*n;

for i=1:length(nfine)
    
    xValPoints=0:1:nfine(i);
    xIntPoints=0:1:n(i);
    
    xInt=x(xIntPoints,n(i));
    yInt=f(xInt);
    
    xVal=x(xValPoints,nfine(i));
    yVal=f(xVal);
    
    figure(i)
    plot(xVal,yVal,'bo','LineWidth',1);
    hold on;
    c=interp_monomials(xInt,yInt);
    c=rot90(c);
    c=rot90(c);
    plot(xVal,polyval(c,xVal),'LineWidth',2);
    xlabel('X');
    ylabel('Y');
    legend('y(x)','interpolation P(x)');
    title('data vs Interpolation n= ',num2str(n(i)));
    
end

% Part D

n_int=33;
N = n_int*100;
points = 0:1:N;


xIntPoints=0:1:n_int;

xInt=x(xIntPoints,n_int);
yInt=f(xInt);

xValues = x(points,N);
yValues = f(xValues);
figure(11)
plot(xValues,yValues,'bo','LineWidth',1);
hold on;
c=interp_monomials(xInt,yInt);
c=rot90(c);
c=rot90(c);
plot(xValues,polyval(c,xValues),'LineWidth',2);
xlabel('X');
ylabel('Y');
legend('y(x)','interpolation P(x)');
title('data vs Interpolation n= ',num2str(n_int));

fprintf("for n>3=3 it is possible to see how the interpolation fails to adjust to the values of f(x)\n")
fprintf("this, could be due to the size of the V matrix and the ill-conditioning of the solution.\n")
fprintf("moreover, the matrix is nearly singular or not scaled correctly at all.\n ")

%% Problem 3

N = 33;
n_fine = 100*N;

xIntPoints=0:1:N;
xInt=x(xIntPoints,N);
yInt=f(xInt);

points = 0:1:n_fine;
xValues = x(points,n_fine);
yValues = f(xValues);

figure(12)
plot(xValues,yValues,'bo','LineWidth',1);
hold on;
intValues = zeros(1,n_fine);

for i=1:n_fine+1
    intValues(i)=Lagrange(xInt,yInt,xValues(i));  
end
plot(xValues,intValues,'LineWidth',2);
xlabel('X');
ylabel('Y');
legend('y(x)','Lagrange interpolation P(x)');
title('data vs Lagrange interpolation n= ',num2str(N));

fprintf('as seen in figure 12, the same bad behavior near the ends is found in the lagrange interpolation\n')
fprintf('this is because lagrange interpolation also creates a polynomial that has to adjust to the curve.\n')
fprintf('moreover, the equispaced interpolation points make the error increase as seen in the graph.\n')
fprintf('therefore, higher ns do not increase accuracy of the interpolation\n')

%% Problem 4

x_cheby=@(i,n) cos(((2*i + 1)*pi)./(2*n+2));

N = 60;
n_fine = 100*N;

xIntPoints=0:1:N;
xInt=x_cheby(xIntPoints,N);
yInt=f(xInt);

points = 0:1:n_fine;
xValues = x(points,n_fine);
yValues = f(xValues);

figure(13)
plot(xValues,yValues,'bo','LineWidth',1);
hold on;
intValues = zeros(1,n_fine);

for i=1:n_fine+1
    intValues(i)=Lagrange(xInt,yInt,xValues(i));  
end

plot(xValues,intValues,'LineWidth',2);
xlabel('X');
ylabel('Y');
legend('y(x)','Lagrange interpolation P(x)');
title('data vs Lagrange interpolation and Chebyshev points n= ',num2str(N));


fprintf('As seen in this example chebyshev points, in comparison to equispaced one do converge\n')
fprintf('and there is a limit to the error the interpolation can have. Because of this, the interpolation\n')
fprintf('behaves much better at the ends and will keep on improving as n increases.\n')
fprintf('to show this, I used an n that is almost double the one in previous examples\n')

%% Problem 5

f1=@(x) sin(x);
f2=@(x) abs(x);

x_cheby=@(i,n) cos(((2*i + 1)*pi)./(2*n+2));

n_array=1:1:16;

fprintf('Error\t sin(x)\t\t abs(x)\n');

for i=1:length(n_array)
    n_fine=n_array(i)*100;
    
    intPoints = 1:1:n_array(i);
    
    x_int=x_cheby(intPoints,n_array(i));
    y_int1=f1(x_int);
    y_int2=f2(x_int);
    
    plotPoints = 1:1:n_fine;
    xValues = x(plotPoints,n_fine);
    y1Values = f1(xValues);
    y2Values = f2(xValues);
    
    sin_int=zeros(1,n_fine);
    abs_int=zeros(1,n_fine);
    
    for j=1:n_fine
        sin_int(j)=Lagrange(x_int,y_int1,xValues(j));
        abs_int(j)=Lagrange(x_int,y_int2,xValues(j));
    end
    
    
    figure(13+i)
    subplot(2,1,1)
    plot(xValues,y1Values,'bo');
    hold on
    plot(xValues,sin_int,'r','LineWidth',2);
    title('data vs Lagrange interpolation and Chebyshev points n= ',num2str(n_array(i)));
    legend('sin(x)','interpolation');
    subplot(2,1,2)
    plot(xValues,y2Values,'ro');
    hold on
    plot(xValues,abs_int,'b','LineWidth',2);
    legend('|x|','interpolation')
    
    fprintf(' n=%2.0f\t %10.10f\t %10.10f\n',n_array(i),max(abs(y1Values-sin_int)),max(abs(y2Values-abs_int)));
    
end

fprintf('\n\nAs seen from the plots, it is possible to notice that the interpolation adjusts\n')
fprintf('correctly to sin(x), but has trouble adjusting to abs(x). One main reason of this is because\n')
fprintf('|x| is not a continuous function, thus, the interpolation polynomial will have trouble interpolation |x|\n')
fprintf('this can be seen at the endpoints of the plots where the interpolation suddenly increases or decreases\n')







##### SOURCE END #####
--></body></html>