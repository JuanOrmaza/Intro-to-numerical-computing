
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>HW4</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-09-21"><meta name="DC.source" content="HW4.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">HomeWork 4</a></li><li><a href="#2">Problem 1.a</a></li><li><a href="#3">Problem 1.b</a></li><li><a href="#4">Problem 2</a></li><li><a href="#5">Problem 2.a</a></li><li><a href="#6">Problem 2.b</a></li><li><a href="#7">Problem 3</a></li><li><a href="#8">Problem 3.a</a></li><li><a href="#9">Problem 3.b</a></li><li><a href="#10">Problem 3.c</a></li></ul></div><h2 id="1">HomeWork 4</h2><p>Juan Alejandro Ormaza CS375 September 21 2021</p><pre class="codeinput">clear <span class="string">all</span>;clc;
format <span class="string">LONGE</span>;
close <span class="string">all</span>;
</pre><h2 id="2">Problem 1.a</h2><pre class="codeinput">ns = [2, 10, 100, 1000, 1500];
times=zeros(1,5);

<span class="keyword">for</span> i=1:5
    n = ns(i);

    <span class="comment">%Create two random vectors of size n</span>
    A = rand(n,n);
    B = rand(n,n);

    <span class="comment">%Measure time using the cputime command</span>
    t = cputime;

    <span class="comment">%Do the epxeriment 100 times (Why?)</span>
    <span class="keyword">for</span> j = 1 : 100
       ip = A*B;    <span class="comment">%Compute Inner Product</span>
    <span class="keyword">end</span>

    <span class="comment">%average the times</span>
    times(i) = (cputime-t)/100.;
<span class="keyword">end</span>
figure(1)
loglog(ns, times, <span class="string">'LineWidth'</span>,3)
ax = gca;
ax.FontSize = 18;
title(<span class="string">'mat-mat operation, O(n^3)'</span>,<span class="string">'fontsize'</span>,18)
ylabel(<span class="string">'Time'</span>,<span class="string">'fontsize'</span>,18)
xlabel(<span class="string">'N'</span>,<span class="string">'fontsize'</span>,18)

fprintf(<span class="string">"The growth of the graph is O(n^3) (straight line with slope representing the growth in loglog)\n"</span>);
fprintf(<span class="string">"as evident from figure 1. This matches the theoretical runtime discussed in class.\n"</span>)
</pre><pre class="codeoutput">The growth of the graph is O(n^3) (straight line with slope representing the growth in loglog)
as evident from figure 1. This matches the theoretical runtime discussed in class.
</pre><img vspace="5" hspace="5" src="HW4_01.png" alt=""> <h2 id="3">Problem 1.b</h2><pre class="codeinput"><span class="keyword">for</span> i=1:5
    n = ns(i);

    <span class="comment">%Create two random vectors of size n</span>
    A = rand(n,n);
    B = rand(n,n);

    <span class="comment">%Measure time using the cputime command</span>
    t = cputime;

    <span class="comment">%Do the epxeriment 100 times (Why?)</span>
    <span class="keyword">for</span> j = 1 : 100
       ip = A*B;
       ip2 = A*B;<span class="comment">%Compute Inner Product</span>
    <span class="keyword">end</span>

    <span class="comment">%average the times</span>
    times(i) = (cputime-t)/100.;
<span class="keyword">end</span>

figure(2)
loglog(ns, times, <span class="string">'LineWidth'</span>,3)
ax = gca;
ax.FontSize = 18;
title(<span class="string">'mat-mat operation, O(n^3)'</span>,<span class="string">'fontsize'</span>,18)
ylabel(<span class="string">'Time'</span>,<span class="string">'fontsize'</span>,18)
xlabel(<span class="string">'N'</span>,<span class="string">'fontsize'</span>,18)

fprintf(<span class="string">"Runtime will be affected if we calculate a*b and c*d. However, it will not affect the big-Oh of the process in general\n"</span>);
fprintf(<span class="string">"That is, doing two O(n^3) operations is still O(n^3) and will only shift the line up or down\n"</span>);
fprintf(<span class="string">"this behavior is indeed exhibited in figure 2 where the line is still O(n^3), but (if compared to figure 1)\n"</span>);
fprintf(<span class="string">"the line is shifted up, yet parallel to the line in the previous figure (that is it is still the same big-oh\n"</span>);
</pre><pre class="codeoutput">Runtime will be affected if we calculate a*b and c*d. However, it will not affect the big-Oh of the process in general
That is, doing two O(n^3) operations is still O(n^3) and will only shift the line up or down
this behavior is indeed exhibited in figure 2 where the line is still O(n^3), but (if compared to figure 1)
the line is shifted up, yet parallel to the line in the previous figure (that is it is still the same big-oh
</pre><img vspace="5" hspace="5" src="HW4_02.png" alt=""> <h2 id="4">Problem 2</h2><pre class="codeinput">solution_array = zeros(10,2);
solution_array2 = zeros(10,2);

<span class="keyword">for</span> i=1:10
    k=i;
    a=10^-2*k;
    A=[a 1; 1 1];
    b=[1+a; 2];

    solution_array(i,:)=GE_naive(A,b);
    solution_array2(i,:)=GE_spp(A,b);
<span class="keyword">end</span>
</pre><h2 id="5">Problem 2.a</h2><pre class="codeinput">solution_array
fprintf(<span class="string">"As k grows and a becomes smaller, the solution in matlab gets to a plateau using GE naive\n"</span>);
fprintf(<span class="string">"In which the values for x1 remain mostly constant and close to 1."</span>);
</pre><pre class="codeoutput">
solution_array =

     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00
     1.000000000000001e+00     1.000000000000000e+00

As k grows and a becomes smaller, the solution in matlab gets to a plateau using GE naive
In which the values for x1 remain mostly constant and close to 1.</pre><h2 id="6">Problem 2.b</h2><pre class="codeinput">solution_array2
fprintf(<span class="string">"For GE spp it is completely different, however, because it seems GE spp introduces some perturbations\n"</span>);
fprintf(<span class="string">"that affect some values in the table for x1. That is, some values are 9.99999e-1 and others are computationally speaking\n"</span>);
fprintf(<span class="string">"exactly one.\n"</span>);
</pre><pre class="codeoutput">
solution_array2 =

     1.000000000000000e+00     1.000000000000000e+00
     1.000000000000000e+00     1.000000000000000e+00
     1.000000000000000e+00     1.000000000000000e+00
     9.999999999999998e-01     1.000000000000000e+00
     9.999999999999998e-01     1.000000000000000e+00
     9.999999999999998e-01     1.000000000000000e+00
     9.999999999999998e-01     1.000000000000000e+00
     1.000000000000000e+00     1.000000000000000e+00
     9.999999999999998e-01     1.000000000000000e+00
     9.999999999999998e-01     1.000000000000000e+00

For GE spp it is completely different, however, because it seems GE spp introduces some perturbations
that affect some values in the table for x1. That is, some values are 9.99999e-1 and others are computationally speaking
exactly one.
</pre><h2 id="7">Problem 3</h2><pre class="codeinput">mat_A=[0.1 0.2 0.3;0.4 0.5 0.6;0.7 0.8 0.9];
vec_b=[0.1; 0.3; 0.5];
</pre><h2 id="8">Problem 3.a</h2><pre class="codeinput">mat_rank=rank(mat_A);
fprintf(<span class="string">"Since the rank for the matrix is 2, we can say that either 2 columns or 2 rows are completely\n"</span>);
fprintf(<span class="string">"independent and that one is dependent of the aforementioned. To demonstrate this we find a y vector that satisfies Ay=0\n"</span>);
y=linsolve(mat_A,vec_b)
</pre><pre class="codeoutput">Since the rank for the matrix is 2, we can say that either 2 columns or 2 rows are completely
independent and that one is dependent of the aforementioned. To demonstrate this we find a y vector that satisfies Ay=0
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.029820e-17. 

y =

     6.327985739750433e-02
     8.734402852049913e-01
    -2.700534759358290e-01

</pre><h2 id="9">Problem 3.b</h2><pre class="codeinput">[x,Y,z]=GE_spp(mat_A,vec_b);
x
fprintf(<span class="string">"notice that the resulting matrix does not have zero values outside the diagonal\n"</span>);
fprintf(<span class="string">"meaning that at some point error propagated and caused the solution to differ radically from the expected solution\n"</span>);
Y
fprintf(<span class="string">"In this code I call the GE spp algorithm which fails from errors coming from division by zero or near zero.\n"</span>);
fprintf(<span class="string">"that is at some point the computer will try to divide something\n"</span>);
</pre><pre class="codeoutput">
x =

                         0
                         0
    -1.718750000000000e-01

notice that the resulting matrix does not have zero values outside the diagonal
meaning that at some point error propagated and caused the solution to differ radically from the expected solution

Y =

     1.428571428571429e-01     8.571428571428570e-02     1.714285714285714e-01
     5.714285714285715e-01     4.999999999999989e-01     1.110223024625157e-16
     7.000000000000000e-01     8.000000000000000e-01     9.000000000000000e-01

In this code I call the GE spp algorithm which fails from errors coming from division by zero or near zero.
that is at some point the computer will try to divide something
</pre><h2 id="10">Problem 3.c</h2><pre class="codeinput">mat_A\vec_b
fprintf(<span class="string">"Matlab does try to return a solution, but it returns a warning message related to the matrix\n"</span>)';
fprintf(<span class="string">"being singular or badly scaled.\n"</span>)
</pre><pre class="codeoutput">Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.029820e-17. 

ans =

     6.327985739750433e-02
     8.734402852049913e-01
    -2.700534759358290e-01

Matlab does try to return a solution, but it returns a warning message related to the matrix
being singular or badly scaled.
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% HomeWork 4
% Juan Alejandro Ormaza
% CS375
% September 21 2021
clear all;clc;
format LONGE;
close all;

%% Problem 1.a

ns = [2, 10, 100, 1000, 1500];
times=zeros(1,5);

for i=1:5
    n = ns(i);
    
    %Create two random vectors of size n
    A = rand(n,n); 
    B = rand(n,n);

    %Measure time using the cputime command
    t = cputime;

    %Do the epxeriment 100 times (Why?)
    for j = 1 : 100 
       ip = A*B;    %Compute Inner Product
    end

    %average the times
    times(i) = (cputime-t)/100.;
end
figure(1)
loglog(ns, times, 'LineWidth',3)
ax = gca;
ax.FontSize = 18; 
title('mat-mat operation, O(n^3)','fontsize',18)
ylabel('Time','fontsize',18)
xlabel('N','fontsize',18)

fprintf("The growth of the graph is O(n^3) (straight line with slope representing the growth in loglog)\n");
fprintf("as evident from figure 1. This matches the theoretical runtime discussed in class.\n")

%% Problem 1.b

for i=1:5
    n = ns(i);
    
    %Create two random vectors of size n
    A = rand(n,n); 
    B = rand(n,n);

    %Measure time using the cputime command
    t = cputime;

    %Do the epxeriment 100 times (Why?)
    for j = 1 : 100 
       ip = A*B;
       ip2 = A*B;%Compute Inner Product
    end

    %average the times
    times(i) = (cputime-t)/100.;
end

figure(2)
loglog(ns, times, 'LineWidth',3)
ax = gca;
ax.FontSize = 18; 
title('mat-mat operation, O(n^3)','fontsize',18)
ylabel('Time','fontsize',18)
xlabel('N','fontsize',18)

fprintf("Runtime will be affected if we calculate a*b and c*d. However, it will not affect the big-Oh of the process in general\n");
fprintf("That is, doing two O(n^3) operations is still O(n^3) and will only shift the line up or down\n");
fprintf("this behavior is indeed exhibited in figure 2 where the line is still O(n^3), but (if compared to figure 1)\n");
fprintf("the line is shifted up, yet parallel to the line in the previous figure (that is it is still the same big-oh\n");


%% Problem 2

solution_array = zeros(10,2);
solution_array2 = zeros(10,2);

for i=1:10
    k=i;
    a=10^-2*k;
    A=[a 1; 1 1];
    b=[1+a; 2];
    
    solution_array(i,:)=GE_naive(A,b);
    solution_array2(i,:)=GE_spp(A,b);
end

%% Problem 2.a

solution_array
fprintf("As k grows and a becomes smaller, the solution in matlab gets to a plateau using GE naive\n");
fprintf("In which the values for x1 remain mostly constant and close to 1.");



%% Problem 2.b

solution_array2
fprintf("For GE spp it is completely different, however, because it seems GE spp introduces some perturbations\n");
fprintf("that affect some values in the table for x1. That is, some values are 9.99999e-1 and others are computationally speaking\n");
fprintf("exactly one.\n");

%% Problem 3

mat_A=[0.1 0.2 0.3;0.4 0.5 0.6;0.7 0.8 0.9];
vec_b=[0.1; 0.3; 0.5];

%% Problem 3.a

mat_rank=rank(mat_A);
fprintf("Since the rank for the matrix is 2, we can say that either 2 columns or 2 rows are completely\n");
fprintf("independent and that one is dependent of the aforementioned. To demonstrate this we find a y vector that satisfies Ay=0\n");
y=linsolve(mat_A,vec_b)

%% Problem 3.b

[x,Y,z]=GE_spp(mat_A,vec_b);
x
fprintf("notice that the resulting matrix does not have zero values outside the diagonal\n");
fprintf("meaning that at some point error propagated and caused the solution to differ radically from the expected solution\n");
Y
fprintf("In this code I call the GE spp algorithm which fails from errors coming from division by zero or near zero.\n");
fprintf("that is at some point the computer will try to divide something\n");

%% Problem 3.c

mat_A\vec_b
fprintf("Matlab does try to return a solution, but it returns a warning message related to the matrix\n")';
fprintf("being singular or badly scaled.\n")



##### SOURCE END #####
--></body></html>